apiVersion: 3
metadata:
  name: pipelines-vote-ui
  namespace: pipelines-vote-ui

components:
  - name: pipelines-vote-ui
    type: git
    metadata:
      repository: https://github.com/basavaraju-G/pipelines-vote-ui
      revision: main
    container:
      image: registry.access.redhat.com/ubi8/nodejs-16:latest
      env:
        - name: DEBUG_PORT
          value: "5858"
      volumeMounts:
        - name: pipelines-vote-ui
          path: /app
      endpoints:
        - name: http-node
          targetPort: 3000
        - name: debug
          targetPort: 5858
          exposure: none
    memoryLimit: 1024Mi
    mountSources: true

volumes:
  - name: pipelines-vote-ui
    type: emptyDir

projects:
  - name: pipelines-vote-ui-dev
    source:
      git:
        url: https://github.com/basavaraju-G/pipelines-vote-ui
        ref: main
    components:
      - name: pipelines-vote-ui
        volumeMounts:
          - name: pipelines-vote-ui
            path: /app
        container:
          workingDir: /app
    tasks:
      - name: install
        steps:
          - name: npm-install
            command: npm install
            component: pipelines-vote-ui
            container:
              workingDir: /app
      - name: run
        steps:
          - name: npm-start
            command: npm start
            component: pipelines-vote-ui
            container:
              workingDir: /app
      - name: debug
        steps:
          - name: npm-debug
            command: npm run debug
            component: pipelines-vote-ui
            container:
              workingDir: /app
      - name: test
        steps:
          - name: npm-test
            command: npm test
            component: pipelines-vote-ui
            container:
              workingDir: /app
